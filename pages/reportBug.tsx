import React, { useEffect, useState } from 'react';
import { useRouter } from 'next/router';
import nookies from "nookies";
import { GetServerSideProps } from "next";
import { useAppDispatch, useAppSelector } from '../lib/hooks';
import { selectUserError, selectUserStatus } from '../lib/features/user/slice';
import { reportBug } from '../lib/features/user/thunks';
import SocialMedia from "../components/SocialMedia";
import FileInput from "../components/Inputs/FileInput";
import Textarea from "../components/Textarea";
import Input from "../components/Inputs/Input";

const reportBugForm = () => {
    const dispatch = useAppDispatch();
    const reduxError = useAppSelector(selectUserError);
    const status = useAppSelector(selectUserStatus);
    const [error, setError] = useState("");
    const [sent, setSent] = useState(false);

    useEffect(() => {
        setError(reduxError ?? "")
    }, [reduxError])

    interface FormData {
        full_name: string;
        email: string;
        bug: string;
        description: string;
        files: File[];
    }
    
    const [formData, setFormData] = useState<FormData>({
        full_name: '',
        email: '',
        bug: '',
        description: '',
        files: []
    });

    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        setFormData({ ...formData, [e.target.name]: e.target.value });
    };

    const handleChangetextarea = (e: React.ChangeEvent<HTMLTextAreaElement>) => {
      setFormData({ ...formData, [e.target.name]: e.target.value });
    };

    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        if (e.target.files) {
            const newFiles = Array.from(e.target.files);
            const updatedFiles = [...formData.files];
    
            newFiles.forEach(newFile => {
                // Check if the file type is allowed and if it already exists in the formData files array
                const isFileTypeAllowed = /\.(svg|png|jpg|jpeg|gif)$/i.test(newFile.name);

                if (!isFileTypeAllowed) setError("only svg, png, jpg, jpeg, gif files are allowed")
                else setError("");

                const doesFileExist = updatedFiles.some(file => file.name === newFile.name);
    
                if (isFileTypeAllowed && !doesFileExist) {
                    updatedFiles.push(newFile); // Add new file if it's an allowed type and doesn't exist
                }
            });
    
            setFormData({ ...formData, files: updatedFiles });
        }
    };

    const handleSubmit = (e: React.FormEvent) => {
        e.preventDefault();
        dispatch(reportBug(formData)).then(() => {
          setSent(true);
        });
    };

    const clearFile = (filename: string) => {
        // Filter out the file with the provided filename
        const updatedFiles = formData.files.filter(file => file.name !== filename);
        
        // Update the state with the new list of files
        setFormData({ ...formData, files: updatedFiles });
    }
    
    return (
        <div className="flex flex-col justify-center lg:justify-start items-center lg:items-start">
            <form onSubmit={handleSubmit} className="w-full px-4 sm:w-full md:max-w-2xl lg:max-w-2xl xl:max-w-3xl bg-white p-6 rounded-[25px] border border-gray-100 ">
                <h1 className={`text-xl md:text-2xl font-bold text-left uppercase pb-4 font-semibold`}>
                  Report a Bug
                </h1>
                <p className={`text-sm sm:text-md border-b border-gray-100 text-neutral-500 pb-4 ${(status === 'succeeded' || status === 'failed') ? "mb-1" : "mb-4"}`}>
                    Help us improve by reporting any bugs you encounter. Please provide detailed information to assist our team in resolving the issue quickly.
                </p>
                 
                  {sent && (
                      <div className="flex flex-col xs:flex-row items-center mt-5">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400" className="w-1/2 xs:w-1/3 h-auto mb-4 md:mb-0 md:ml-8"><g fill="#000000"><path d="M270.84 134.92c0.14 0 0.24 -0.24 0 -0.3 -1.4 -0.38 -0.72 -1.08 -0.5 -1.16s1.6 -1.02 0.98 -2.24c0 -0.12 -0.24 0 -0.22 0 0.22 0.9 -0.34 1.38 -0.98 1.82a1.28 1.28 0 0 0 -0.6 0.74c-0.04 0.72 0.74 1.16 1.32 1.14zM276 132a5.86 5.86 0 0 0 0.56 -2.2 0.24 0.24 0 0 0 -0.44 -0.12 6.14 6.14 0 0 0 -0.62 2.2 0.3 0.3 0 0 0 0.5 0.12zm-7.28 -3.36a10 10 0 0 0 -0.72 2.76 0.22 0.22 0 0 0 0.38 0.16 4.74 4.74 0 0 0 0.62 -2.92 0.14 0.14 0 0 0 -0.28 0zm9.28 0.42a0.24 0.24 0 0 0 0.38 -0.28 7.78 7.78 0 0 0 -1.68 -2 0.24 0.24 0 0 0 -0.38 0.3 7.68 7.68 0 0 0 1.68 1.98zm-10.52 -1.7a7.02 7.02 0 0 0 1.5 -1.76 0.16 0.16 0 0 0 -0.24 -0.22 6.18 6.18 0 0 0 -1.54 1.68c-0.16 0.2 0.08 0.48 0.28 0.3zm7.72 11.42c0 -0.22 -0.26 -0.42 -0.42 -0.24a4.7 4.7 0 0 1 -5.74 1.74 0.18 0.18 0 0 0 -0.14 0.32 4.56 4.56 0 0 0 6.3 -1.82zm17 94.94a20.64 20.64 0 0 1 -5.44 -7.72c0 -0.12 -0.24 0 -0.2 0 2 5.76 7.62 11.62 14 12.16 0.1 0 0.1 -0.12 0 -0.16a25.18 25.18 0 0 1 -8.36 -4.28zM108.32 88.22l-2.26 28.66 35.7 24.14 -17.6 -56.32 -15.84 3.52zm35.4 52.3 16.4 -39.84 -17.72 -22.64 -15.16 5.82 16.48 56.66z" stroke-width="1"></path><path d="M376.36 264.8a4.22 4.22 0 0 0 -2.18 -2.88c-5.64 -3.88 -28 -19.8 -34.26 -23.84v-0.7c0.36 0 2.66 0 2.78 -3.64 4.42 -1.84 6 -7.78 6.76 -12.12a50.6 50.6 0 0 0 -1.32 -23.62 50 50 0 0 0 -10.14 -18.26c-8 -9.16 -28.82 -21.54 -43.12 -24.28a64.92 64.92 0 0 0 -4.54 -6 49.84 49.84 0 0 0 1.56 -9.08l6.48 -11.32s6.64 -9.64 -6 -9.64c0 0 -2.34 -10.14 -8.12 -9.56 0 0 -2.96 0.76 -2.9 2.76 0 0 -8 -9.3 -16.14 -5.18a5.8 5.8 0 0 0 -2.6 5.78 13.6 13.6 0 0 0 4 8 28 28 0 0 0 -2.32 6.96 36.26 36.26 0 0 0 -1.26 9.6c0.18 3.78 2.3 9.08 7.36 10.28a15.72 15.72 0 0 0 -0.12 1.82 16.18 16.18 0 0 0 -10.14 8.12 56.86 56.86 0 0 0 -18.28 9.22c-3.22 -26.64 -16.1 -132.62 -16.9 -139.26 -0.56 -4.48 -0.78 -9.2 -4.58 -12.24a21.4 21.4 0 0 0 -11.18 -4c-6.32 -0.62 -174 -1.72 -174 -1.72 -13.2 -0.18 -11.52 13.1 -11.52 13.1s39.24 336 40.74 350.26c1.3 12.32 13.38 14.8 16.74 15.24 0 0 132.74 -12.54 148.28 -14.44 -0.34 2.62 -0.88 3 -0.88 3 -2.48 3.08 -12 6 -12 6 -1.72 1.34 -0.46 4.38 -0.46 4.38 1.36 0.2 25.74 0.9 25.74 0.9 0.84 -1.3 -2.84 -4.68 0.24 -16a29.7 29.7 0 0 0 4 0.16 5.5 5.5 0 0 0 3.84 -1.48 13.28 13.28 0 0 0 13.7 -8.72 28 28 0 0 0 0.46 -10.64c-0.12 -2 -1.56 -18 -2.66 -28.84l8.58 -30.16 -9.06 -35.08 -6.34 -5.4c-0.44 -0.76 0.38 -0.32 0.38 -0.32l6.74 5.46 25.52 99.74c-4.16 -0.2 -2 5.46 -1.48 8 0.5 2.32 0.58 4.9 3.1 5.86a11.02 11.02 0 0 0 3.58 0.58 19.44 19.44 0 0 1 0.18 6.74c-2.14 3.32 -11.3 7.16 -11.3 7.16 -1.58 1.5 0 4.4 0 4.4 1.38 0 25.7 -1.82 25.7 -1.82 0.7 -1.4 -2 -7.46 -2.3 -16.66a24.76 24.76 0 0 0 2.76 -0.36c1.9 -0.34 2.16 -1.46 2.44 -3.36a25.06 25.06 0 0 0 -0.58 -8.44c-0.28 -1.46 -0.68 -2.16 -2 -2.32l2.66 -98.08c1.84 -0.5 3.66 -1.42 4 -3.1a141.54 141.54 0 0 0 -0.98 -24c8.46 5.82 14.56 10 16.66 11.36a2.52 2.52 0 0 0 0.36 1.56 7.1 7.1 0 0 0 4.68 2.3 3.8 3.8 0 0 0 0.68 0c5.18 4 26.98 18.54 32.64 22.14 0.86 0.56 5.8 2.16 7.76 -0.52a5.18 5.18 0 0 0 0.56 -3.8zM295.14 156c14.32 3.56 36.26 14.92 45.44 27.78a49.64 49.64 0 0 1 9.06 25.08 48.62 48.62 0 0 1 -1.04 14.44c-0.84 3.76 -2.38 8.62 -6.22 10l-9.06 -2c-4 -1.66 -5.48 -21.68 -6.42 -26l0.7 0.22c0.4 0.14 0.6 -0.5 0.18 -0.64a48.84 48.84 0 0 1 -21.36 -11.46h-0.1a26.72 26.72 0 0 0 7.3 6.22c-0.44 3.08 -0.66 16.28 -0.72 20.66 -11.12 -7.54 -25.58 -17.26 -40 -27.02 0.6 -2.26 3.2 -8.22 17.58 -26.2 1.96 -2.38 6.5 -8.2 4.66 -11.08zm18.86 44a65.74 65.74 0 0 0 12.54 5.26c0.34 6 1.6 12 2.42 17.86 0.38 2.68 0.86 6.46 3 8.24a6.72 6.72 0 0 0 -0.18 2c-2.84 -2 -9.4 -6.5 -18.12 -12.4A206.26 206.26 0 0 0 314 200zm-47.4 -34.98c1.26 1.66 3.82 1.64 5.68 1.54a24.22 24.22 0 0 0 13.56 -6c-1.02 4.92 -7.04 16.9 -9.36 21.4a40.9 40.9 0 0 0 -4.18 11.26l-14.96 -10a96.62 96.62 0 0 1 8.42 -22.1 5.7 5.7 0 0 0 0.84 3.9zm1.62 -1.82c1.48 1.68 4 1.52 6 1.24a21.74 21.74 0 0 0 12.4 -6.18 16 16 0 0 1 -0.9 1.8 25.8 25.8 0 0 1 -10.22 5.5 15.28 15.28 0 0 1 -5.38 0.46c-3.6 -0.32 -4.14 -3.08 -4 -6l0.9 -1.66a5.82 5.82 0 0 0 1.2 4.84zm26.64 -5.88a8 8 0 0 1 -1.28 3.64 53.4 53.4 0 0 1 -6.66 9.78q-6.36 8 -12.16 16.26a173.1 173.1 0 0 0 15.42 -37c0.9 1.2 4.54 6 4.68 7.32zm-29.54 -14.54a4.5 4.5 0 0 0 0.26 0.84 13.42 13.42 0 0 1 -1.82 -8.66 43.8 43.8 0 0 1 3.22 -13.5 17.32 17.32 0 0 0 10.38 4.22 22.44 22.44 0 0 0 9.4 -0.92l-1.18 5.38s4.36 -3.12 5.38 2.92a4.76 4.76 0 0 1 -2.78 4.2l3.44 2.88a85.12 85.12 0 0 1 -4.74 17.52 30.72 30.72 0 0 1 -9.26 5.56 17.5 17.5 0 0 1 -5.26 1c-4.6 0 -5.1 -3.26 -4.72 -6.72 1.04 -1.84 2.14 -3.68 3.28 -5.46a0.22 0.22 0 0 0 0 -0.2c0.1 -1.2 0 -2.46 0 -3.66a8 8 0 0 0 6.94 -1.82 6 6 0 0 0 2 -3.5c0.46 -2.52 0.6 -6.72 -3.26 -7.5a13.86 13.86 0 0 0 -7.66 0.82 5.88 5.88 0 0 0 -3.62 6.6zm1.7 -1.44a3.44 3.44 0 0 1 0.86 -2.84 6.96 6.96 0 0 1 4.82 -1.84c3.18 0 5.56 0.88 5.84 3.04s0.62 4.32 -3.42 4.54l-0.5 -1.1a0.56 0.56 0 0 0 -0.56 -0.34h-1.02a0.54 0.54 0 0 0 -0.52 0.46l-0.24 1.3s-4.76 1.18 -5.26 -3.22zm3.28 8.84a6.86 6.86 0 0 0 0.14 1.66c-5.54 7.42 -10.84 20.96 -13.18 29.5a110.84 110.84 0 0 1 1.62 -18 17 17 0 0 1 11.42 -13.16zm-13.52 32.52 -6.28 -4.22a47.54 47.54 0 0 1 1.56 -4.96 0.1 0.1 0 0 0 -0.2 0 16.66 16.66 0 0 0 -1.86 4.68l-11.46 -7.66A67.38 67.38 0 0 1 260 158.4c-2.52 4.62 -3.08 19.16 -3.22 24.3zM81.1 388.36c-5.38 -2.48 -6.98 -10.22 -6.98 -10.22l-42 -351.02c-2.18 -11.24 1.38 -15.36 3.02 -16.62 14.36 -0.24 170.6 1.22 176.5 2.38 5.42 1.06 10.44 3.64 11.72 9.44 1.4 6.34 14.28 116.42 17.8 145.42 -1.26 0.96 -2.26 1.82 -3.02 2.5L232 166.12c-4 -35.54 -15.48 -125.9 -16.74 -135.8 0 -0.28 -57.9 -0.96 -67.32 -0.94l-0.92 -0.34a52.5 52.5 0 0 0 -25.56 -3.62A95.82 95.82 0 0 0 100.46 30c-20.24 -0.42 -40.82 -1.22 -61.08 -1.16 -0.28 0 7.2 59.48 9.12 73.44v4.54a63.54 63.54 0 0 0 1.58 12.3c0.28 1.06 0.58 2 0.88 3.12 3.46 34.8 27.46 225.44 29.48 243.34a0.28 0.28 0 0 0 0.34 0.24c5 0.2 124.6 -12 147.74 -14.68l-0.44 3.8c-3.52 -1.34 -3.8 7.24 -3.58 9.04 0.26 2.18 2.46 3.5 4.18 4.54l0.86 0.5a41.78 41.78 0 0 1 -0.2 4.76c-13.82 0.6 -148.2 14.52 -148.24 14.58zm168.66 -147.16 -0.54 15.24c-0.34 3.18 -4.18 0.32 -4.18 0.32l-4.4 -2.32a40.42 40.42 0 0 1 -6.98 -8.56 23.68 23.68 0 0 1 0.22 -4.74c3.74 4.8 8.54 12.7 15.22 12.64 0.18 0 0.24 -0.34 0 -0.34 -7 -0.32 -12.8 -10.7 -15.18 -12.82 0.52 -3.42 1.54 -6.86 2.28 -10.14q1.7 -7.46 3.64 -14.92c2.52 -9.72 5.74 -19.24 8.32 -28.94l7.24 5.06c-2.06 8.9 -5.96 45.4 -5.64 49.52zm-21.1 108.98c-28 3.64 -141.68 14.84 -147.7 15.08C77.54 334.5 55.4 153.44 52 125.28c8.62 27.04 27.62 44.26 52.16 51.36 1.12 8.38 2.94 16.74 4.46 25.08 0 0.22 0.48 0.2 0.52 0.2 16.94 0.58 85 -4.8 102.48 -6a19.6 19.6 0 0 0 14.44 9.52 21.88 21.88 0 0 0 9.44 -0.82 99.74 99.74 0 0 0 2 18.22c-0.7 2.8 -1.38 5.62 -2 8.44 -1.08 4.72 -2.7 9.74 -2.42 14.64a54 54 0 0 0 6.66 8.46zm-180 -252c-1.68 -15.24 -6.94 -58 -8.66 -68.88 20 0.86 38.88 0.9 58.82 1.3l-1.1 0.42c-7.52 3.2 -15.42 6.62 -21.82 11.76a63.2 63.2 0 0 0 -8.8 9.54 85.86 85.86 0 0 0 -6.66 9.18 80 80 0 0 0 -11.8 36.64zM56 71.76a85.6 85.6 0 0 1 12.34 -19.56 55.78 55.78 0 0 1 8.26 -8.84 57.1 57.1 0 0 1 10.76 -6.6C94.48 33.24 102 29.34 110 28c8.44 -1.52 17.5 -3.12 26 -1.36a108.16 108.16 0 0 1 24.24 8.78 76 76 0 0 1 36.58 99.72 80 80 0 0 1 -28.54 34c-14.44 9.62 -31.82 11.66 -48.78 9.88a77.66 77.66 0 0 1 -66 -50.66c-1.12 -3.02 -2.62 -9.46 -2.66 -9.6A77.78 77.78 0 0 1 56 71.76zm130.96 -16.44A77.16 77.16 0 0 0 170 40l-1.86 -1.18c7.66 1.18 31.38 2.54 37.86 2.32 1.74 12.26 3.2 24.58 5.18 36.8 -3.68 0.2 -8 -0.16 -11.68 0a75.52 75.52 0 0 0 -12.64 -22.62zm17 99.76a11.16 11.16 0 0 0 -2.24 -1.54c-1.46 -1.32 -8.22 -6 -10 -7.06 0.44 -0.68 2.4 -4 2.94 -4.94a113.68 113.68 0 0 0 12.5 8.62c-1.72 0.54 -2.86 3.56 -3.3 4.92zm-1.22 14.36a79.86 79.86 0 0 0 2.18 10.16 59.38 59.38 0 0 0 6.36 15.68c-18.16 1.32 -93.86 6 -102 6.18 -1.48 -8.3 -2.62 -16.46 -4.48 -24.66 0.96 0.26 1.9 0.56 2.88 0.8a96 96 0 0 0 25.82 2.54 69.32 69.32 0 0 0 25.1 -4.84 75.64 75.64 0 0 0 32.86 -28.56c1.26 1.04 6.58 4.86 9.18 6.4a5.12 5.12 0 0 0 1.58 3.4 12.62 12.62 0 0 1 2.48 5 3.14 3.14 0 0 0 -0.92 2.86 5.36 5.36 0 0 0 -1.14 5.04zM238 220.66c-0.32 -2.98 -1.28 -11.44 -2 -16.32a29.78 29.78 0 0 0 7.22 -3.62c-1.48 5.18 -2.82 10.44 -4.18 15.6 -0.36 1.44 -0.72 2.9 -1.04 4.34zm5.56 -20.88c-2.92 2 -25.82 16.5 -36.86 -16.8 -5.06 -15.32 -3.38 -17.16 -2.6 -18.12a12.44 12.44 0 0 0 7.56 0.22c4 0.44 6.76 4.38 9.04 7.34a56.7 56.7 0 0 1 6 10.1c0.16 0.36 3.28 -4.76 6.38 -6.6l14.92 10.5c-1.76 4.36 -3.2 8.82 -4.5 13.36zm-16.74 -18.48a51.72 51.72 0 0 0 -7.38 -11.3c-0.66 -0.76 -1.44 -1.7 -2.32 -2.58a27.5 27.5 0 0 0 -0.24 -2.88c4.64 3.3 10 7.06 15.68 11.1a17.18 17.18 0 0 0 -5.8 5.66zm-10.28 -17.04a17.58 17.58 0 0 0 0.16 2.72 7.28 7.28 0 0 0 -4.34 -2.28c0 -0.48 0 -3.34 -1.3 -3.6v-0.78zm-5.82 -5.54a5.82 5.82 0 0 0 0 2.5 11.46 11.46 0 0 1 -5.42 0 10.74 10.74 0 0 0 -1 -2.92c-0.8 -1.52 -2.9 -3.12 -2.96 -4.86a16.52 16.52 0 0 1 2.6 2s0.12 0.12 0.18 0a0.2 0.2 0 0 0 0 -0.14c0.64 -1.14 2 -5.24 4 -5.04 0.84 0.58 0.32 2.76 0.14 3.4a7.36 7.36 0 0 1 -1.76 2.94c-0.12 0.14 0 0.32 0.18 0.2a7.06 7.06 0 0 0 2.26 -5.52 0.92 0.92 0 0 1 1.44 0.54c0.52 1.76 -1.6 5.18 -2.56 6 -0.18 0.16 0 0.42 0.26 0.26a8.26 8.26 0 0 0 2.66 -6.54c3.06 2.6 0.3 5.92 -0.08 7.18zm0 -7.3a1.24 1.24 0 0 0 -1.78 -0.5 1.06 1.06 0 0 0 -0.68 -0.84 1.84 1.84 0 0 0 -0.56 0 104.74 104.74 0 0 0 -12.82 -8.8c0.4 -0.76 0.74 -1.52 1.12 -2.28a121.66 121.66 0 0 0 17.3 -0.34c0.28 5.38 1.16 10.78 1.78 16.14l-3.08 -1.94a3.14 3.14 0 0 0 -1.44 -1.44zm2.88 -13.22a0.14 0.14 0 0 0 -0.18 0s-11.48 0 -17.24 0.48a78.84 78.84 0 0 0 3.42 -60.42 41.4 41.4 0 0 0 11.66 0.22c0.12 0 0.42 -0.32 0.4 -0.46 -2 -12.34 -2.88 -24.88 -5.2 -37.18 0 0 -0.18 -0.28 -0.32 -0.28 -3.44 0.14 -31.04 -1.62 -38.4 -2A107.02 107.02 0 0 0 149.22 30c11.56 0.36 53.2 1.18 65.54 1.02 4 34.62 14.9 122.62 16.48 134.7l-15.66 -10.46a0.28 0.28 0 0 0 0 -0.14c-0.66 -5.68 -1.08 -11.4 -2.14 -16.92zM240 378.36s-6.56 5.36 -9.62 -2.96a46.12 46.12 0 0 0 0 -5.76 27.58 27.58 0 0 0 10.92 2.98 42.66 42.66 0 0 0 -1.46 5.74zm-1.86 -7.12a25.46 25.46 0 0 1 -9.68 -3.68 5.76 5.76 0 0 1 -2.86 -6.12c0 -1.48 0 -6.54 2.88 -5.74 7.84 8.46 19.72 4.44 22 3.64 2.3 1.02 1.5 1.84 0.96 5.74a12.96 12.96 0 0 1 -1.58 5c-2.26 3.2 -8.78 1.72 -11.86 1.16zm22.82 -46.62c1.06 11.66 2.38 27.04 2.5 30.76 0.16 4.18 -0.4 8.24 -3.44 11.36a13 13 0 0 1 -9.44 3.58l0.12 -0.16a24.34 24.34 0 0 0 1.78 -8.48c0.26 -2.14 0.14 -2.42 -1.46 -2.92zM250.4 238c1.22 -10 4.26 -37.66 5.38 -46l14.18 9.88a98.76 98.76 0 0 0 -3.4 40.22zm43.14 137.76c-0.1 -0.5 -0.12 -3.16 -0.28 -4 1.36 0 8.4 0 10.94 -0.18 0 1.28 0.24 5.62 0.26 6.52 -5.82 6.02 -10.64 -1.86 -10.92 -2.38zm15.74 -13.88a15.6 15.6 0 0 1 0.18 6.8c-0.82 2.42 -3.08 2.22 -5.32 2.3 -1.78 0 -15.44 1.24 -17.08 -2.74a34.14 34.14 0 0 1 -0.92 -8.84 1.18 1.18 0 0 1 1.16 -1.06l20 -0.2c1.56 0.62 1.7 2.06 1.98 3.7zm4.34 -109.88a12.14 12.14 0 0 1 -0.3 4c-0.66 1.34 -2.68 2 -4.44 2.36l-28.64 2.72c-6.38 -0.16 -8.4 -4 -8.4 -4l-0.76 -2.44a63.18 63.18 0 0 0 42.44 -4.18 6 6 0 0 1 0.1 1.54zm-0.12 -2.24a71.04 71.04 0 0 1 -42.52 4.54l-3.8 -12a119.46 119.46 0 0 1 3.1 -40.2c15.84 11.02 31.22 21.64 42.48 29.4 -0.14 4.3 0.94 18.2 0.74 18.28zm-102.5 -90a5.78 5.78 0 0 1 0.62 -2 6.82 6.82 0 0 0 0.92 -3.28 4.66 4.66 0 0 0 -0.16 -0.92c19.06 13.64 108.8 72.86 119.44 80.58a18 18 0 0 0 -4.82 1.84c-0.86 0.56 -1.28 1.24 -0.8 1.8s1.32 1.48 4.52 1.9a10.26 10.26 0 0 0 -0.86 2.6c-16 -10.54 -109.12 -75.88 -118.86 -82.54zm120.54 85.26c-2 -1.34 -1.28 -3.46 -0.52 -5.32a0.54 0.54 0 0 0 -0.24 -0.4c-8.5 -2.48 -0.8 -2.82 1.3 -4.66a9.76 9.76 0 0 0 7.3 2.82c0 2.76 -0.16 7.66 -3.36 8.66a5.72 5.72 0 0 1 -4.48 -1.12zm43.34 23.7c-2.24 1.86 -6.46 0 -6.52 0 -5.3 -3.72 -26.44 -18.14 -32.44 -21.82 2.98 -0.68 4 -5.22 4 -8.26 6.28 4.94 34.44 24 34.46 24a3.7 3.7 0 0 1 1.48 2.74 4 4 0 0 1 -0.98 3.32z" stroke-width="1"></path><path d="M109.86 166.78c14 3.46 30.52 3.78 44 -1.8a65.78 65.78 0 0 0 30 -26.6 67.66 67.66 0 0 0 -4.9 -76.96c-8.8 -10.9 -20.4 -17.68 -33.4 -22.48 -7.44 -2.74 -14.48 -4.6 -22.46 -3.7a76 76 0 0 0 -21.48 4.92A80.96 80.96 0 0 0 83.12 50a62.5 62.5 0 0 0 -13.48 16 68.88 68.88 0 0 0 -10.58 39.14 60.82 60.82 0 0 0 1.38 11.12 67.54 67.54 0 0 0 49.42 50.52zM66 74.44a78.66 78.66 0 0 1 10.9 -16.74 45.52 45.52 0 0 1 16.16 -12.68c6.38 -3.1 12.96 -6.5 20 -7.6 7.58 -1.18 15.2 -2.56 22.78 -0.72A81.18 81.18 0 0 1 172 55.3a66.48 66.48 0 0 1 15 74.9A68.9 68.9 0 0 1 162 159.82c-12.4 8 -27.26 9.74 -41.74 8.2a67.52 67.52 0 0 1 -39.32 -17.5c-9.82 -9.16 -18.5 -25.8 -19.74 -34.52 -2.02 -14 -1.2 -28.62 4.8 -41.56z" stroke-width="1"></path><path d="M150.64 85.48a0.38 0.38 0 0 0 0.68 0.38 40.78 40.78 0 0 0 5.38 -10.86c0 -0.16 -7.14 -14.14 -11.32 -20.54 -0.12 -0.18 -0.46 0 -0.38 0.16 1.36 3.48 10.8 20.52 10.86 20.56 -0.86 1.62 -4.34 8.48 -5.22 10.3zm7.9 11.2a64.88 64.88 0 0 0 10.16 -0.46 2 2 0 0 0 0.38 -0.3c0.8 -0.96 1.5 -10.98 1.76 -14 0 -0.24 -0.36 -0.28 -0.42 0a119.5 119.5 0 0 0 -2 13.54 88.26 88.26 0 0 0 -10 0.58c-0.42 0.08 -0.22 0.62 0.12 0.64zm11.3 21.48a73.38 73.38 0 0 0 -12.36 -4.54 0.18 0.18 0 0 0 -0.14 0.34 83 83 0 0 0 12.26 5.26c-0.66 3.68 -3.86 18.14 -4 21.74a0.3 0.3 0 0 0 0.58 0c1 -3.78 4.22 -18.7 4 -22.32 0.04 0.04 -0.18 -0.4 -0.34 -0.48zM109.4 143.3a67.62 67.62 0 0 0 6.6 -15.88c0 -0.28 -0.34 -0.46 -0.46 -0.2 -1.3 2.7 -6 13.18 -6.9 15.74a0.9 0.9 0 0 0 0 0.6c2 1.84 12 7.72 14.52 9.3 0.5 0.3 0.96 -0.48 0.46 -0.8 -2.46 -1.58 -14.22 -8.74 -14.22 -8.76zm-18.92 -26.56c3.78 -0.22 7.7 -0.32 11.46 -0.76a0.5 0.5 0 0 0 0 -1 48.72 48.72 0 0 0 -11.16 0.8 122.38 122.38 0 0 0 -4.34 -14.28 0.26 0.26 0 0 0 -0.5 0.12 70.48 70.48 0 0 0 4 14.72 1.02 1.02 0 0 0 0.54 0.4zm12.96 -17.4c0.64 0.42 1.24 -0.62 0.6 -1.04 -2 -1.34 -8.74 -6.16 -10.26 -6.46 0 0 4.28 -19.4 4.64 -23.14 0 -0.28 -0.42 -0.32 -0.48 0 -1.18 3.86 -4.66 19.64 -5.14 23.36 -0.04 0.24 8.52 5.94 10.64 7.28zm13.28 -28.96a11.72 11.72 0 0 0 -4.3 13.06L133.88 78a10.8 10.8 0 0 0 -11.68 -9.48s-2 -18.4 11.9 -27.6c0 0 0 -0.24 -0.16 -0.2 -15.78 7.68 -12.84 27.8 -12.82 27.86a11.2 11.2 0 0 0 -3.4 1.06c-0.34 -0.5 -8.54 -15.3 -23.76 -19.34v0.12a50.34 50.34 0 0 1 22.76 19.96zm102.32 139.8c-37.5 2.24 -133.82 7.38 -144.5 7.8a0.66 0.66 0 0 0 -0.38 0.42c0.68 9.06 5.58 45.84 7.86 54.84a0.26 0.26 0 0 0 0.26 0.34c37.74 -3.06 134.72 -12.48 145.5 -13.56 0.26 0 0.54 -0.66 0.52 -0.82 -3.5 -16.2 -6.1 -32.44 -8.84 -48.76 -0.02 -0.12 -0.32 -0.26 -0.42 -0.26zm-136.56 62.8c-1.1 -8.92 -3 -17.78 -4.26 -26.68 -1.32 -9.28 -2.2 -18.64 -3.5 -28 9.22 0.5 133.64 -7.04 144.24 -7.64a445.46 445.46 0 0 0 8.64 48.6c-37.6 3.34 -134.4 12.58 -145.12 13.72zM216.2 270c0.36 4.82 6.7 47.88 8.18 57.42 -9.28 1.5 -105.88 14.36 -115.5 14.54 0 0 -9.26 -50.24 -9.44 -60.34 9.58 -0.62 97.22 -9.2 116.6 -11.68 0.34 0 0.36 -0.58 0 -0.56 -19.66 1.42 -107.26 10.48 -116.88 11.78a0.2 0.2 0 0 0 -0.16 0.22s-1 5.7 9.22 60.62c0 0 0.12 0.56 0.36 0.56 9.68 0.24 116.64 -14.2 116.6 -14.58 -1.3 -9.52 -7.28 -53.08 -8.62 -58a0.18 0.18 0 0 0 -0.36 0.02z" stroke-width="1"></path><path d="M90.56 227.42a43.44 43.44 0 0 0 -8.54 0.92 0.18 0.18 0 0 0 0 0.34 81.16 81.16 0 0 0 8.6 -0.58c0.42 -0.1 0.32 -0.7 -0.06 -0.68zm4.06 0.1a7.42 7.42 0 0 0 2.68 0 0.24 0.24 0 0 0 0 -0.34 7 7 0 0 0 -2.68 0 0.26 0.26 0 0 0 0 0.34zm6.38 -0.64c5.3 0 26.24 -1.46 31.36 -2 0.46 0 0.48 -0.74 0 -0.72 -5.3 0.14 -26.3 1.6 -31.42 2.3 -0.26 0.02 -0.18 0.42 0.06 0.42zm37.84 -2.36c0.48 0 0.52 -0.8 0 -0.78a14 14 0 0 0 -3.04 0.18 0.24 0.24 0 0 0 0 0.46 15.42 15.42 0 0 0 3.04 0.14zm7.42 -0.3a0.34 0.34 0 0 0 0 -0.68 18 18 0 0 0 -3.82 0.26 0.14 0.14 0 0 0 0 0.22 19.46 19.46 0 0 0 3.82 0.2zm2.92 -0.7c5.28 -0.1 26.44 -1.36 31.68 -2 0.48 0 0.52 -0.78 0 -0.78 -5.26 0 -26.44 1.52 -31.68 2.18 -0.34 0.12 -0.36 0.62 0 0.6zm38.34 -2.9a257.88 257.88 0 0 0 28.54 -1.52c0.4 0 0.3 -0.72 0 -0.72 -4.88 0 -24 1.2 -28.5 1.82 -0.34 0.04 -0.26 0.4 -0.04 0.42zM198 226.8c-0.16 0 0 0.26 0 0.26a72.54 72.54 0 0 0 7.8 0 0.34 0.34 0 0 0 0 -0.68 25.76 25.76 0 0 0 -7.8 0.42zm10.92 -0.34c2.98 -0.24 6 -0.64 8.92 -0.7 0.46 0 0.46 -0.74 0 -0.72a46.54 46.54 0 0 0 -8.98 0.94 0.24 0.24 0 0 0 0.06 0.48zm-16.24 0.62c-4.36 0.46 -22 1.48 -26.28 2a0.26 0.26 0 0 0 0 0.5c4.36 0.26 22 -1.26 26.28 -1.8 0.46 -0.02 0.48 -0.76 0 -0.7zm-29.54 3.12c0.52 0 0.52 -0.8 0 -0.82a15.2 15.2 0 0 0 -4.36 0.36c-0.32 0 -0.26 0.62 0 0.6a38.26 38.26 0 0 1 4.36 -0.14zm-7.92 0c-6.3 0.34 -31.02 2 -36.86 3.12 -0.2 0 -0.14 0.32 0 0.32 6.12 0 30.68 -2.28 36.82 -2.6 0.58 -0.04 0.58 -0.86 0.04 -0.84zm-42.88 3.22A270.54 270.54 0 0 0 84.8 236c-0.16 0 -0.12 0.26 0 0.26 4.56 0 22.94 -1.88 27.52 -2.24a0.34 0.34 0 0 0 0.02 -0.6zM98 244.48c0.44 0 0.26 -0.74 -0.18 -0.66a111.02 111.02 0 0 1 -11.22 1.14 0.22 0.22 0 0 0 0 0.44 46.4 46.4 0 0 0 11.4 -0.92zm6.12 -1.3a9.18 9.18 0 0 0 -3.12 0.42 0.44 0.44 0 0 0 0.12 0.28 12.16 12.16 0 0 0 3.06 -0.18 0.28 0.28 0 0 0 -0.06 -0.52zm3.4 -0.18c-0.22 0 -0.16 0.38 0 0.38 5 0 25.16 -1.48 30.16 -2 0.38 0 0.4 -0.62 0 -0.6 -5.14 0.06 -25.36 1.42 -30.16 2.22zm34 -2.24c11.1 -0.98 22.16 -2 33.32 -2.34 0.42 0 0.42 -0.68 0 -0.66a270 270 0 0 0 -33.38 2.52c-0.28 0.04 -0.22 0.5 0.06 0.48zm36.28 -3.22c-0.16 0 -0.16 0.3 0 0.32a10 10 0 0 0 2.8 0c0.52 0 0.38 -0.84 0 -0.68a17.52 17.52 0 0 1 -2.8 0.36zm32.2 -2.72c-8.76 0.56 -17.64 0.92 -26.32 2.18 -0.26 0 -0.2 0.46 0 0.44 8.74 -0.34 17.5 -1.38 26.26 -2 0.52 0.04 0.52 -0.66 0.06 -0.62zm4.72 -0.28v0.28a10.96 10.96 0 0 0 3.36 0c0.4 0 0.42 -0.66 0 -0.64a22.24 22.24 0 0 0 -3.36 0.36zM206 246c5.06 -0.38 10.22 -0.62 15.26 -1.18 0.4 0 0.42 -0.64 0 -0.64a94 94 0 0 0 -15.34 1.32c-0.26 0.12 -0.2 0.6 0.08 0.5zm-3.1 0c-0.42 0 -2 0.12 -2.36 0.2s-0.16 0.24 0 0.32a3.58 3.58 0 0 0 2.58 0.12c0.4 -0.16 0.2 -0.76 -0.22 -0.64zm-14.54 1.18v0.16a17.64 17.64 0 0 0 8 -0.64c0.14 -0.18 0 -0.46 -0.16 -0.46a25.28 25.28 0 0 0 -7.84 0.94zm-6.24 0.48c-9 1 -45.18 4 -54.18 4.88a0.22 0.22 0 0 0 0 0.44c9.04 0 45.18 -3.52 54.18 -4.62 0.44 -0.06 0.46 -0.76 0 -0.7zM122 253.32c-3.5 0 -16.38 0.56 -18.92 1.76 -0.22 0 0 0.4 0.14 0.36 6.22 -1.02 12.52 -1 18.78 -1.56 0.38 -0.04 0.38 -0.58 0 -0.56zm-22.58 1.84c-0.82 0.14 -3.16 0.46 -2.98 0.72s2.42 0 3.08 0a0.36 0.36 0 1 0 -0.1 -0.72zm-6.18 0.84a20 20 0 0 0 -3.78 0.2c-0.16 0 -0.24 0.28 0 0.32a9.16 9.16 0 0 0 3.9 0 0.3 0.3 0 0 0 -0.12 -0.52z" stroke-width="1"></path></g></svg>

                        <p className="w-full xs:w-2/3 text-sm md:text-base text-left md:ml-8">
                            Thank you for your bug report. We apologize for any inconvenience caused. Please allow us up to 24 hours to address this issue. Your assistance is invaluable to us, and we are working diligently to resolve it. We appreciate your patience.
                        </p>
                      </div>
                  )}
                  {status === 'failed' || error && <p className="text-left text-red-500 text-sm mb-2">* {error}</p>}


                  {!sent && status !== 'failed' && (
                    <>
                        <div className="grid sm:grid-cols-2 grid-cols-1 sm:gap-4">
                            <Input headerText="Full Name" placeholder="Full Name" name="full_name" value={formData.full_name} onChange={handleChange} />
                            <Input headerText="Email" placeholder="Email" name="email" value={formData.email} onChange={handleChange} />
                        </div>

                        <Input headerText="What is the Bug" placeholder="What is the bug" name="bug" value={formData.bug} onChange={handleChange} />

                        <Textarea 
                            headerText="Description of the Bug" 
                            placeholder="Give us a description of the bug and how to reproduce it" 
                            name="description" 
                            value={formData.description} 
                            onChange={handleChangetextarea} 
                        />

                        <FileInput files={formData.files} headerText="Snapshot of the Bug" onFileChange={handleFileChange} clearFile={clearFile}/>

                        <div className="mt-10 flex flex-col md:flex-row justify-end items-center w-full">
                            <button className="w-full md:w-auto px-12 py-2 bg-primary text-black rounded-[25px] uppercase mb-4 md:mb-0 order-1 md:order-2 text-sm">
                                Submit
                            </button>
                        </div>
                    </>
                )}
            </form>
            <SocialMedia />
        </div>
    );
}



export const getServerSideProps: GetServerSideProps = async (context) => {
  // Check authentication (e.g., check cookies or token)
  const cookies = nookies.get(context);
  const token = cookies['access_token'];
  const refresh_token = cookies['refresh_token'];
  if (!token || !refresh_token) {
    return {
      redirect: {
        destination: '/landing',
        permanent: false,
      },
    };
  }
  return { props: {} };
};

export default reportBugForm;
